//////////////////////////////////////
// Form Elements styling
//////////////////////////////////////

(function(a){a.uniform={options:{selectClass:"selector",radioClass:"radio",checkboxClass:"checker",fileClass:"uploader",filenameClass:"filename",fileBtnClass:"action",fileDefaultText:"No file selected",fileBtnText:"Choose File",checkedClass:"checked",focusClass:"focus",disabledClass:"disabled",buttonClass:"button",activeClass:"active",hoverClass:"hover",useID:true,idPrefix:"uniform",resetSelector:false,autoHide:true},elements:[]};if(a.browser.msie&&a.browser.version<7){a.support.selectOpacity=false}else{a.support.selectOpacity=true}a.fn.uniform=function(k){k=a.extend(a.uniform.options,k);var d=this;if(k.resetSelector!=false){a(k.resetSelector).mouseup(function(){function l(){a.uniform.update(d)}setTimeout(l,10)})}function j(l){$el=a(l);$el.addClass($el.attr("type"));b(l)}function g(l){a(l).addClass("uniform");b(l)}function i(o){var m=a(o);var p=a("<div>"),l=a("<span>");p.addClass(k.buttonClass);if(k.useID&&m.attr("id")!=""){p.attr("id",k.idPrefix+"-"+m.attr("id"))}var n;if(m.is("a")||m.is("button")){n=m.text()}else{if(m.is(":submit")||m.is(":reset")||m.is("input[type=button]")){n=m.attr("value")}}n=n==""?m.is(":reset")?"Reset":"Submit":n;l.html(n);m.css("opacity",0);m.wrap(p);m.wrap(l);p=m.closest("div");l=m.closest("span");if(m.is(":disabled")){p.addClass(k.disabledClass)}p.bind({"mouseenter.uniform":function(){p.addClass(k.hoverClass)},"mouseleave.uniform":function(){p.removeClass(k.hoverClass);p.removeClass(k.activeClass)},"mousedown.uniform touchbegin.uniform":function(){p.addClass(k.activeClass)},"mouseup.uniform touchend.uniform":function(){p.removeClass(k.activeClass)},"click.uniform touchend.uniform":function(r){if(a(r.target).is("span")||a(r.target).is("div")){if(o[0].dispatchEvent){var q=document.createEvent("MouseEvents");q.initEvent("click",true,true);o[0].dispatchEvent(q)}else{o[0].click()}}}});o.bind({"focus.uniform":function(){p.addClass(k.focusClass)},"blur.uniform":function(){p.removeClass(k.focusClass)}});a.uniform.noSelect(p);b(o)}function e(o){var m=a(o);var p=a("<div />"),l=a("<span />");if(!m.css("display")=="none"&&k.autoHide){p.hide()}p.addClass(k.selectClass);if(k.useID&&o.attr("id")!=""){p.attr("id",k.idPrefix+"-"+o.attr("id"))}var n=o.find(":selected:first");if(n.length==0){n=o.find("option:first")}l.html(n.html());o.css("opacity",0);o.wrap(p);o.before(l);p=o.parent("div");l=o.siblings("span");o.bind({"change.uniform":function(){l.text(o.find(":selected").html());p.removeClass(k.activeClass)},"focus.uniform":function(){p.addClass(k.focusClass)},"blur.uniform":function(){p.removeClass(k.focusClass);p.removeClass(k.activeClass)},"mousedown.uniform touchbegin.uniform":function(){p.addClass(k.activeClass)},"mouseup.uniform touchend.uniform":function(){p.removeClass(k.activeClass)},"click.uniform touchend.uniform":function(){p.removeClass(k.activeClass)},"mouseenter.uniform":function(){p.addClass(k.hoverClass)},"mouseleave.uniform":function(){p.removeClass(k.hoverClass);p.removeClass(k.activeClass)},"keyup.uniform":function(){l.text(o.find(":selected").html())}});if(a(o).attr("disabled")){p.addClass(k.disabledClass)}a.uniform.noSelect(l);b(o)}function f(n){var m=a(n);var o=a("<div />"),l=a("<span />");if(!m.css("display")=="none"&&k.autoHide){o.hide()}o.addClass(k.checkboxClass);if(k.useID&&n.attr("id")!=""){o.attr("id",k.idPrefix+"-"+n.attr("id"))}a(n).wrap(o);a(n).wrap(l);l=n.parent();o=l.parent();a(n).css("opacity",0).bind({"focus.uniform":function(){o.addClass(k.focusClass)},"blur.uniform":function(){o.removeClass(k.focusClass)},"click.uniform touchend.uniform":function(){if(!a(n).attr("checked")){l.removeClass(k.checkedClass)}else{l.addClass(k.checkedClass)}},"mousedown.uniform touchbegin.uniform":function(){o.addClass(k.activeClass)},"mouseup.uniform touchend.uniform":function(){o.removeClass(k.activeClass)},"mouseenter.uniform":function(){o.addClass(k.hoverClass)},"mouseleave.uniform":function(){o.removeClass(k.hoverClass);o.removeClass(k.activeClass)}});if(a(n).attr("checked")){l.addClass(k.checkedClass)}if(a(n).attr("disabled")){o.addClass(k.disabledClass)}b(n)}function c(n){var m=a(n);var o=a("<div />"),l=a("<span />");if(!m.css("display")=="none"&&k.autoHide){o.hide()}o.addClass(k.radioClass);if(k.useID&&n.attr("id")!=""){o.attr("id",k.idPrefix+"-"+n.attr("id"))}a(n).wrap(o);a(n).wrap(l);l=n.parent();o=l.parent();a(n).css("opacity",0).bind({"focus.uniform":function(){o.addClass(k.focusClass)},"blur.uniform":function(){o.removeClass(k.focusClass)},"click.uniform touchend.uniform":function(){if(!a(n).attr("checked")){l.removeClass(k.checkedClass)}else{var p=k.radioClass.split(" ")[0];a("."+p+" span."+k.checkedClass+":has([name='"+a(n).attr("name")+"'])").removeClass(k.checkedClass);l.addClass(k.checkedClass)}},"mousedown.uniform touchend.uniform":function(){if(!a(n).is(":disabled")){o.addClass(k.activeClass)}},"mouseup.uniform touchbegin.uniform":function(){o.removeClass(k.activeClass)},"mouseenter.uniform touchend.uniform":function(){o.addClass(k.hoverClass)},"mouseleave.uniform":function(){o.removeClass(k.hoverClass);o.removeClass(k.activeClass)}});if(a(n).attr("checked")){l.addClass(k.checkedClass)}if(a(n).attr("disabled")){o.addClass(k.disabledClass)}b(n)}function h(q){var o=a(q);var r=a("<div />"),p=a("<span>"+k.fileDefaultText+"</span>"),m=a("<span>"+k.fileBtnText+"</span>");if(!o.css("display")=="none"&&k.autoHide){r.hide()}r.addClass(k.fileClass);p.addClass(k.filenameClass);m.addClass(k.fileBtnClass);if(k.useID&&o.attr("id")!=""){r.attr("id",k.idPrefix+"-"+o.attr("id"))}o.wrap(r);o.after(m);o.after(p);r=o.closest("div");p=o.siblings("."+k.filenameClass);m=o.siblings("."+k.fileBtnClass);if(!o.attr("size")){var l=r.width();o.attr("size",l/10)}var n=function(){var s=o.val();if(s===""){s=k.fileDefaultText}else{s=s.split(/[\/\\]+/);s=s[(s.length-1)]}p.text(s)};n();o.css("opacity",0).bind({"focus.uniform":function(){r.addClass(k.focusClass)},"blur.uniform":function(){r.removeClass(k.focusClass)},"mousedown.uniform":function(){if(!a(q).is(":disabled")){r.addClass(k.activeClass)}},"mouseup.uniform":function(){r.removeClass(k.activeClass)},"mouseenter.uniform":function(){r.addClass(k.hoverClass)},"mouseleave.uniform":function(){r.removeClass(k.hoverClass);r.removeClass(k.activeClass)}});if(a.browser.msie){o.bind("click.uniform.ie7",function(){setTimeout(n,0)})}else{o.bind("change.uniform",n)}if(o.attr("disabled")){r.addClass(k.disabledClass)}a.uniform.noSelect(p);a.uniform.noSelect(m);b(q)}a.uniform.restore=function(l){if(l==undefined){l=a(a.uniform.elements)}a(l).each(function(){if(a(this).is(":checkbox")){a(this).unwrap().unwrap()}else{if(a(this).is("select")){a(this).siblings("span").remove();a(this).unwrap()}else{if(a(this).is(":radio")){a(this).unwrap().unwrap()}else{if(a(this).is(":file")){a(this).siblings("span").remove();a(this).unwrap()}else{if(a(this).is("button, :submit, :reset, a, input[type='button']")){a(this).unwrap().unwrap()}}}}}a(this).unbind(".uniform");a(this).css("opacity","1");var m=a.inArray(a(l),a.uniform.elements);a.uniform.elements.splice(m,1)})};function b(l){l=a(l).get();if(l.length>1){a.each(l,function(m,n){a.uniform.elements.push(n)})}else{a.uniform.elements.push(l)}}a.uniform.noSelect=function(l){function m(){return false}a(l).each(function(){this.onselectstart=this.ondragstart=m;a(this).mousedown(m).css({MozUserSelect:"none"})})};a.uniform.update=function(l){if(l==undefined){l=a(a.uniform.elements)}l=a(l);l.each(function(){var n=a(this);if(n.is("select")){var m=n.siblings("span");var p=n.parent("div");p.removeClass(k.hoverClass+" "+k.focusClass+" "+k.activeClass);m.html(n.find(":selected").html());if(n.is(":disabled")){p.addClass(k.disabledClass)}else{p.removeClass(k.disabledClass)}}else{if(n.is(":checkbox")){var m=n.closest("span");var p=n.closest("div");p.removeClass(k.hoverClass+" "+k.focusClass+" "+k.activeClass);m.removeClass(k.checkedClass);if(n.is(":checked")){m.addClass(k.checkedClass)}if(n.is(":disabled")){p.addClass(k.disabledClass)}else{p.removeClass(k.disabledClass)}}else{if(n.is(":radio")){var m=n.closest("span");var p=n.closest("div");p.removeClass(k.hoverClass+" "+k.focusClass+" "+k.activeClass);m.removeClass(k.checkedClass);if(n.is(":checked")){m.addClass(k.checkedClass)}if(n.is(":disabled")){p.addClass(k.disabledClass)}else{p.removeClass(k.disabledClass)}}else{if(n.is(":file")){var p=n.parent("div");var o=n.siblings(k.filenameClass);btnTag=n.siblings(k.fileBtnClass);p.removeClass(k.hoverClass+" "+k.focusClass+" "+k.activeClass);o.text(n.val());if(n.is(":disabled")){p.addClass(k.disabledClass)}else{p.removeClass(k.disabledClass)}}else{if(n.is(":submit")||n.is(":reset")||n.is("button")||n.is("a")||l.is("input[type=button]")){var p=n.closest("div");p.removeClass(k.hoverClass+" "+k.focusClass+" "+k.activeClass);if(n.is(":disabled")){p.addClass(k.disabledClass)}else{p.removeClass(k.disabledClass)}}}}}}})};return this.each(function(){if(a.support.selectOpacity){var l=a(this);if(l.is("select")){if(l.attr("multiple")!=true && l.attr("multiple") != "multiple"){if(l.attr("size")==undefined||l.attr("size")<=1){e(l)}}}else{if(l.is(":checkbox")){f(l)}else{if(l.is(":radio")){c(l)}else{if(l.is(":file")){h(l)}else{if(l.is(":text, :password, input[type='email']")){j(l)}else{if(l.is("textarea")){g(l)}else{if(l.is("a")||l.is(":submit")||l.is(":reset")||l.is("button")||l.is("input[type=button]")){i(l)}}}}}}}}})}})(jQuery);

//////////////////////////////////////
// Form Validation Engine
//////////////////////////////////////

(function(e){var t={init:function(n){var r=this;if(!r.data("jqv")||r.data("jqv")==null){n=t._saveOptions(r,n);e(".formError").live("click",function(){e(this).fadeOut(150,function(){e(this).parent(".formErrorOuter").remove();e(this).remove()})})}return this},attach:function(n){var r=this;var i;if(n)i=t._saveOptions(r,n);else i=r.data("jqv");var s=r.find("[data-validation-engine*=validate]")?"data-validation-engine":"class";if(!i.binded){if(i.bindMethod=="bind"){r.find("[class*=validate]").not("[type=checkbox]").not("[type=radio]").not(".datepicker").bind(i.validationEventTrigger,t._onFieldEvent);r.find("[class*=validate][type=checkbox],[class*=validate][type=radio]").bind("click",t._onFieldEvent);r.find("[class*=validate][class*=datepicker]").bind(i.validationEventTrigger,{delay:300},t._onFieldEvent);r.bind("submit",t._onSubmitEvent)}else if(i.bindMethod=="live"){r.find("[class*=validate]").not("[type=checkbox]").not(".datepicker").live(i.validationEventTrigger,t._onFieldEvent);r.find("[class*=validate][type=checkbox]").live("click",t._onFieldEvent);r.find("[class*=validate][class*=datepicker]").live(i.validationEventTrigger,{delay:300},t._onFieldEvent);r.live("submit",t._onSubmitEvent)}i.binded=true;if(i.autoPositionUpdate){e(window).bind("resize",{noAnimation:true,formElem:r},t.updatePromptsPosition)}}return this},detach:function(){var n=this;var r=n.data("jqv");if(r.binded){n.find("[class*=validate]").not("[type=checkbox]").unbind(r.validationEventTrigger,t._onFieldEvent);n.find("[class*=validate][type=checkbox],[class*=validate][type=radio]").unbind("click",t._onFieldEvent);n.unbind("submit",t.onAjaxFormComplete);n.find("[class*=validate]").not("[type=checkbox]").die(r.validationEventTrigger,t._onFieldEvent);n.find("[class*=validate][type=checkbox]").die("click",t._onFieldEvent);n.die("submit",t.onAjaxFormComplete);n.removeData("jqv");if(r.autoPositionUpdate){e(window).unbind("resize",t.updatePromptsPosition)}}return this},validate:function(){return t._validateFields(this)},validateField:function(n){var r=e(this).data("jqv");var i=t._validateField(e(n),r);if(r.onSuccess&&r.InvalidFields.length==0)r.onSuccess();else if(r.onFailure&&r.InvalidFields.length>0)r.onFailure();return i},validateform:function(){return t._onSubmitEvent.call(this)},updatePromptsPosition:function(n){if(n&&this==window)var r=n.data.formElem,i=n.data.noAnimation;else var r=e(this.closest("form"));var s=r.data("jqv");r.find("[class*=validate]").not(":hidden").not(":disabled").each(function(){var n=e(this);var r=t._getPrompt(n);var o=e(r).find(".formErrorContent").html();if(r)t._updatePrompt(n,e(r),o,undefined,false,s,i)});return this},showPrompt:function(e,n,r,i){var s=this.closest("form");var o=s.data("jqv");if(!o)o=t._saveOptions(this,o);if(r)o.promptPosition=r;o.showArrow=i==true;t._showPrompt(this,e,n,false,o);return this},hidePrompt:function(){var n="."+t._getClassName(e(this).attr("id"))+"formError";e(n).fadeTo("fast",.3,function(){e(this).parent(".formErrorOuter").remove();e(this).remove()});return this},hide:function(){var n;if(e(this).is("form")){n="parentForm"+t._getClassName(e(this).attr("id"))}else{n=t._getClassName(e(this).attr("id"))+"formError"}e("."+n).fadeTo("fast",.3,function(){e(this).parent(".formErrorOuter").remove();e(this).remove()});return this},hideAll:function(){e(".formError").fadeTo("fast",.3,function(){e(this).parent(".formErrorOuter").remove();e(this).remove()});return this},_onFieldEvent:function(n){var r=e(this);var i=r.closest("form");var s=i.data("jqv");window.setTimeout(function(){t._validateField(r,s);if(s.InvalidFields.length==0&&s.onSuccess){s.onSuccess()}else if(s.InvalidFields.length>0&&s.onFailure){s.onFailure()}},n.data?n.data.delay:0)},_onSubmitEvent:function(){var n=e(this);var r=n.data("jqv");var i=t._validateFields(n,true);if(i&&r.ajaxFormValidation){t._validateFormWithAjax(n,r);return false}if(r.onValidationComplete){r.onValidationComplete(n,i);return false}return i},_checkAjaxStatus:function(t){var n=true;e.each(t.ajaxValidCache,function(e,t){if(!t){n=false;return false}});return n},_validateFields:function(n,r){var i=n.data("jqv");var s=false;n.trigger("jqv.form.validating");var o=null;n.find("[class*=validate]").not(":hidden").not(":disabled").each(function(){var n=e(this);s|=t._validateField(n,i,r);n.focus();if(i.doNotShowAllErrosOnSubmit)return false;if(s&&o==null)o=n});n.trigger("jqv.form.result",[s]);if(s){if(i.scroll){var u=o.offset().top;var a=o.offset().left;var f=i.promptPosition;if(typeof f=="string"){if(f.indexOf(":")!=-1){f=f.substring(0,f.indexOf(":"))}}if(f!="bottomRight"&&f!="bottomLeft"){var l=t._getPrompt(o);u=l.offset().top}if(i.isOverflown){var c=e(i.overflownDIV);if(!c.length)return false;var h=c.scrollTop();var p=-parseInt(c.offset().top);u+=h+p-5;var d=e(i.overflownDIV+":not(:animated)");d.animate({scrollTop:u},1100)}else{e("html:not(:animated),body:not(:animated)").animate({scrollTop:u,scrollLeft:a},1100,function(){if(i.focusFirstField)o.focus()})}}else if(i.focusFirstField)o.focus();return false}return true},_validateFormWithAjax:function(n,r){var i=n.serialize();var s=r.ajaxFormValidationURL?r.ajaxFormValidationURL:n.attr("action");e.ajax({type:"GET",url:s,cache:false,dataType:"json",data:i,form:n,methods:t,options:r,beforeSend:function(){return r.onBeforeAjaxFormValidation(n,r)},error:function(e,n){t._ajaxError(e,n)},success:function(i){if(i!==true){var s=false;for(var o=0;o<i.length;o++){var u=i[o];var a=u[0];var f=e(e("#"+a)[0]);if(f.length==1){var l=u[2];if(u[1]==true){if(l==""||!l){t._closePrompt(f)}else{if(r.allrules[l]){var c=r.allrules[l].alertTextOk;if(c)l=c}t._showPrompt(f,l,"pass",false,r,true)}}else{s|=true;if(r.allrules[l]){var c=r.allrules[l].alertText;if(c)l=c}t._showPrompt(f,l,"",false,r,true)}}}r.onAjaxFormComplete(!s,n,i,r)}else r.onAjaxFormComplete(true,n,"",r)}})},_validateField:function(n,r,i){if(!n.attr("id"))e.error("jQueryValidate: an ID attribute is required for this field: "+n.attr("name")+" class:"+n.attr("class"));var s=n.attr("class");var o=/validate\[(.*)\]/.exec(s);if(!o)return false;var u=o[1];var a=u.split(/\[|,|\]/);var f=false;var l=n.attr("name");var c="";var h=false;r.isError=false;r.showArrow=true;var p=e(n.closest("form"));for(var d=0;d<a.length;d++){a[d]=a[d].replace(" ","");var v=undefined;switch(a[d]){case"required":h=true;v=t._required(n,a,d,r);break;case"custom":v=t._customRegex(n,a,d,r);break;case"groupRequired":var m="[class*="+a[d+1]+"]";var g=p.find(m).eq(0);if(g[0]!=n[0]){t._validateField(g,r,i);r.showArrow=true;continue}v=t._groupRequired(n,a,d,r);if(v)h=true;r.showArrow=false;break;case"ajax":if(!i){t._ajax(n,a,d,r);f=true}break;case"minSize":v=t._minSize(n,a,d,r);break;case"maxSize":v=t._maxSize(n,a,d,r);break;case"min":v=t._min(n,a,d,r);break;case"max":v=t._max(n,a,d,r);break;case"past":v=t._past(n,a,d,r);break;case"future":v=t._future(n,a,d,r);break;case"dateRange":var m="[class*="+a[d+1]+"]";var g=p.find(m).eq(0);var y=p.find(m).eq(1);if(g[0].value||y[0].value){v=t._dateRange(g,y,a,d,r)}if(v)h=true;r.showArrow=false;break;case"dateTimeRange":var m="[class*="+a[d+1]+"]";var g=p.find(m).eq(0);var y=p.find(m).eq(1);if(g[0].value||y[0].value){v=t._dateTimeRange(g,y,a,d,r)}if(v)h=true;r.showArrow=false;break;case"maxCheckbox":v=t._maxCheckbox(p,n,a,d,r);n=e(p.find("input[name='"+l+"']"));break;case"minCheckbox":v=t._minCheckbox(p,n,a,d,r);n=e(p.find("input[name='"+l+"']"));break;case"equals":v=t._equals(n,a,d,r);break;case"funcCall":v=t._funcCall(n,a,d,r);break;case"creditCard":v=t._creditCard(n,a,d,r);break;default:}if(v!==undefined){c+=v+"<br/>";r.isError=true}}if(!h&&n.val()=="")r.isError=false;var b=n.prop("type");if((b=="radio"||b=="checkbox")&&p.find("input[name='"+l+"']").size()>1){n=e(p.find("input[name='"+l+"'][type!=hidden]:first"));r.showArrow=false}if(b=="text"&&p.find("input[name='"+l+"']").size()>1){n=e(p.find("input[name='"+l+"'][type!=hidden]:first"));r.showArrow=false}if(r.isError){t._showPrompt(n,c,"",false,r)}else{if(!f)t._closePrompt(n)}if(!f){n.trigger("jqv.field.result",[n,r.isError,c])}var w=e.inArray(n[0],r.InvalidFields);if(w==-1){if(r.isError)r.InvalidFields.push(n[0])}else if(!r.isError){r.InvalidFields.splice(w,1)}return r.isError},_required:function(e,t,n,r){switch(e.prop("type")){case"text":case"password":case"textarea":case"file":default:if(!e.val())return r.allrules[t[n]].alertText;break;case"radio":case"checkbox":var i=e.closest("form");var s=e.attr("name");if(i.find("input[name='"+s+"']:checked").size()==0){if(i.find("input[name='"+s+"']").size()==1)return r.allrules[t[n]].alertTextCheckboxe;else return r.allrules[t[n]].alertTextCheckboxMultiple}break;case"select-one":if(!e.val())return r.allrules[t[n]].alertText;break;case"select-multiple":if(!e.find("option:selected").val())return r.allrules[t[n]].alertText;break}},_groupRequired:function(n,r,i,s){var o="[class*="+r[i+1]+"]";var u=false;n.closest("form").find(o).each(function(){if(!t._required(e(this),r,i,s)){u=true;return false}});if(!u)return s.allrules[r[i]].alertText},_customRegex:function(e,t,n,r){var i=t[n+1];var s=r.allrules[i];if(!s){alert("jqv:custom rule not found "+i);return}var o=s.regex;if(!o){alert("jqv:custom regex not found "+i);return}var u=new RegExp(o);if(!u.test(e.val()))return r.allrules[i].alertText},_funcCall:function(e,t,n,r){var i=t[n+1];var s=window[i]||r.customFunctions[i];if(typeof s=="function")return s(e,t,n,r)},_equals:function(t,n,r,i){var s=n[r+1];if(t.val()!=e("#"+s).val())return i.allrules.equals.alertText},_maxSize:function(e,t,n,r){var i=t[n+1];var s=e.val().length;if(s>i){var o=r.allrules.maxSize;return o.alertText+i+o.alertText2}},_minSize:function(e,t,n,r){var i=t[n+1];var s=e.val().length;if(s<i){var o=r.allrules.minSize;return o.alertText+i+o.alertText2}},_min:function(e,t,n,r){var i=parseFloat(t[n+1]);var s=parseFloat(e.val());if(s<i){var o=r.allrules.min;if(o.alertText2)return o.alertText+i+o.alertText2;return o.alertText+i}},_max:function(e,t,n,r){var i=parseFloat(t[n+1]);var s=parseFloat(e.val());if(s>i){var o=r.allrules.max;if(o.alertText2)return o.alertText+i+o.alertText2;return o.alertText+i}},_past:function(e,n,r,i){var s=n[r+1];var o=s.toLowerCase()=="now"?new Date:t._parseDate(s);var u=t._parseDate(e.val());if(u>o){var a=i.allrules.past;if(a.alertText2)return a.alertText+t._dateToString(o)+a.alertText2;return a.alertText+t._dateToString(o)}},_future:function(e,n,r,i){var s=n[r+1];var o=s.toLowerCase()=="now"?new Date:t._parseDate(s);var u=t._parseDate(e.val());if(u<o){var a=i.allrules.future;if(a.alertText2)return a.alertText+t._dateToString(o)+a.alertText2;return a.alertText+t._dateToString(o)}},_isDate:function(e){var t=new RegExp(/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$|^(?:(?:(?:0?[13578]|1[02])(\/|-)31)|(?:(?:0?[1,3-9]|1[0-2])(\/|-)(?:29|30)))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(?:(?:0?[1-9]|1[0-2])(\/|-)(?:0?[1-9]|1\d|2[0-8]))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(0?2(\/|-)29)(\/|-)(?:(?:0[48]00|[13579][26]00|[2468][048]00)|(?:\d\d)?(?:0[48]|[2468][048]|[13579][26]))$/);if(t.test(e)){return true}return false},_isDateTime:function(e){var t=new RegExp(/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])\s+(1[012]|0?[1-9]){1}:(0?[1-5]|[0-6][0-9]){1}:(0?[0-6]|[0-6][0-9]){1}\s+(am|pm|AM|PM){1}$|^(?:(?:(?:0?[13578]|1[02])(\/|-)31)|(?:(?:0?[1,3-9]|1[0-2])(\/|-)(?:29|30)))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^((1[012]|0?[1-9]){1}\/(0?[1-9]|[12][0-9]|3[01]){1}\/\d{2,4}\s+(1[012]|0?[1-9]){1}:(0?[1-5]|[0-6][0-9]){1}:(0?[0-6]|[0-6][0-9]){1}\s+(am|pm|AM|PM){1})$/);if(t.test(e)){return true}return false},_dateCompare:function(e,t){return new Date(e.toString())<new Date(t.toString())},_dateRange:function(e,n,r,i,s){if(!e[0].value&&n[0].value||e[0].value&&!n[0].value){return s.allrules[r[i]].alertText+s.allrules[r[i]].alertText2}if(!t._isDate(e[0].value)||!t._isDate(n[0].value)){return s.allrules[r[i]].alertText+s.allrules[r[i]].alertText2}if(!t._dateCompare(e[0].value,n[0].value)){return s.allrules[r[i]].alertText+s.allrules[r[i]].alertText2}},_dateTimeRange:function(e,n,r,i,s){if(!e[0].value&&n[0].value||e[0].value&&!n[0].value){return s.allrules[r[i]].alertText+s.allrules[r[i]].alertText2}if(!t._isDateTime(e[0].value)||!t._isDateTime(n[0].value)){return s.allrules[r[i]].alertText+s.allrules[r[i]].alertText2}if(!t._dateCompare(e[0].value,n[0].value)){return s.allrules[r[i]].alertText+s.allrules[r[i]].alertText2}},_maxCheckbox:function(e,t,n,r,i){var s=n[r+1];var o=t.attr("name");var u=e.find("input[name='"+o+"']:checked").size();if(u>s){i.showArrow=false;if(i.allrules.maxCheckbox.alertText2)return i.allrules.maxCheckbox.alertText+" "+s+" "+i.allrules.maxCheckbox.alertText2;return i.allrules.maxCheckbox.alertText}},_minCheckbox:function(e,t,n,r,i){var s=n[r+1];var o=t.attr("name");var u=e.find("input[name='"+o+"']:checked").size();if(u<s){i.showArrow=false;return i.allrules.minCheckbox.alertText+" "+s+" "+i.allrules.minCheckbox.alertText2}},_creditCard:function(e,t,n,r){var i=false,s=e.val().replace(/ +/g,"").replace(/-+/g,"");var o=s.length;if(o>=14&&o<=16&&parseInt(s)>0){var u=0,n=o-1,a=1,f,l=new String;do{f=parseInt(s.charAt(n));l+=a++%2==0?f*2:f}while(--n>=0);for(n=0;n<l.length;n++){u+=parseInt(l.charAt(n))}i=u%10==0}if(!i)return r.allrules.creditCard.alertText},_ajax:function(n,r,i,s){var o=r[i+1];var u=s.allrules[o];var a=u.extraData;var f=u.extraDataDynamic;if(!a)a="";if(f){var l=[];var c=String(f).split(",");for(var i=0;i<c.length;i++){var h=c[i];if(e(h).length){var p=n.closest("form").find(h).val();var d=h.replace("#","")+"="+escape(p);l.push(d)}}f=l.join("&")}else{f=""}if(!s.isError){e.ajax({type:"GET",url:u.url,cache:false,dataType:"json",data:"fieldId="+n.attr("id")+"&fieldValue="+n.val()+"&extraData="+a+"&"+f,field:n,rule:u,methods:t,options:s,beforeSend:function(){var e=u.alertTextLoad;if(e)t._showPrompt(n,e,"load",true,s)},error:function(e,n){t._ajaxError(e,n)},success:function(n){var r=n[0];var i=e(e("#"+r)[0]);if(i.length==1){var o=n[1];var a=n[2];if(!o){s.ajaxValidCache[r]=false;s.isError=true;if(a){if(s.allrules[a]){var f=s.allrules[a].alertText;if(f)a=f}}else a=u.alertText;t._showPrompt(i,a,"",true,s)}else{if(s.ajaxValidCache[r]!==undefined)s.ajaxValidCache[r]=true;if(a){if(s.allrules[a]){var f=s.allrules[a].alertTextOk;if(f)a=f}}else a=u.alertTextOk;if(a)t._showPrompt(i,a,"pass",true,s);else t._closePrompt(i)}}i.trigger("jqv.field.result",[i,!s.isError,a])}})}},_ajaxError:function(e,t){if(e.status==0&&t==null)alert("The page is not served from a server! ajax call failed");else if(typeof console!="undefined")console.log("Ajax error: "+e.status+" "+t)},_dateToString:function(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},_parseDate:function(e){var t=e.split("-");if(t==e)t=e.split("/");return new Date(t[0],t[1]-1,t[2])},_showPrompt:function(e,n,r,i,s,o){var u=t._getPrompt(e);if(o)u=false;if(u)t._updatePrompt(e,u,n,r,i,s);else t._buildPrompt(e,n,r,i,s)},_buildPrompt:function(n,r,i,s,o){var u=e("<div>");u.addClass(t._getClassName(n.attr("id"))+"formError");if(n.is(":input"))u.addClass("parentForm"+t._getClassName(n.parents("form").attr("id")));u.addClass("formError");switch(i){case"pass":u.addClass("greenPopup");break;case"load":u.addClass("blackPopup");break;default:o.InvalidCount++}if(s)u.addClass("ajaxed");var a=e("<div>").addClass("formErrorContent").html(r).appendTo(u);if(o.showArrow){var f=e("<div>").addClass("formErrorArrow");var l=n.data("promptPosition")||o.promptPosition;if(typeof l=="string"){if(l.indexOf(":")!=-1){l=l.substring(0,l.indexOf(":"))}}switch(l){case"bottomLeft":case"bottomRight":u.find(".formErrorContent").before(f);f.addClass("formErrorArrowBottom").html('<div class="line1"><!-- --></div><div class="line2"><!-- --></div><div class="line3"><!-- --></div><div class="line4"><!-- --></div><div class="line5"><!-- --></div><div class="line6"><!-- --></div><div class="line7"><!-- --></div><div class="line8"><!-- --></div><div class="line9"><!-- --></div><div class="line10"><!-- --></div>');break;case"topLeft":case"topRight":f.html('<div class="line10"><!-- --></div><div class="line9"><!-- --></div><div class="line8"><!-- --></div><div class="line7"><!-- --></div><div class="line6"><!-- --></div><div class="line5"><!-- --></div><div class="line4"><!-- --></div><div class="line3"><!-- --></div><div class="line2"><!-- --></div><div class="line1"><!-- --></div>');u.append(f);break}}if(o.relative){var c=e("<span>").css("position","relative").css("vertical-align","top").addClass("formErrorOuter").append(u.css("position","absolute"));n.before(c)}else if(o.isOverflown){n.before(u)}else{e("body").append(u)}var h=t._calculatePosition(n,u,o);u.css({top:h.callerTopPosition,left:h.callerleftPosition,marginTop:h.marginTopSize,opacity:0}).data("callerField",n);if(o.autoHidePrompt){setTimeout(function(){u.animate({opacity:0},function(){u.closest(".formErrorOuter").remove();u.remove()})},o.autoHideDelay);return u.animate({opacity:.87})}else{return u.animate({opacity:.87})}},_updatePrompt:function(e,n,r,i,s,o,u){if(n){if(typeof i!=="undefined"){if(i=="pass")n.addClass("greenPopup");else n.removeClass("greenPopup");if(i=="load")n.addClass("blackPopup");else n.removeClass("blackPopup")}if(s)n.addClass("ajaxed");else n.removeClass("ajaxed");n.find(".formErrorContent").html(r);var a=t._calculatePosition(e,n,o);css={top:a.callerTopPosition,left:a.callerleftPosition,marginTop:a.marginTopSize};if(u)n.css(css);else n.animate(css)}},_closePrompt:function(e){var n=t._getPrompt(e);if(n)n.fadeTo("fast",0,function(){n.parent(".formErrorOuter").remove();n.remove()})},closePrompt:function(e){return t._closePrompt(e)},_getPrompt:function(n){var r=t._getClassName(n.attr("id"))+"formError";var i=e("."+t._escapeExpression(r))[0];if(i)return e(i)},_escapeExpression:function(e){return e.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g,"\\$1")},isRTL:function(t){var n=e(document);var r=e("body");var i=t&&t.hasClass("rtl")||t&&(t.attr("dir")||"").toLowerCase()==="rtl"||n.hasClass("rtl")||(n.attr("dir")||"").toLowerCase()==="rtl"||r.hasClass("rtl")||(r.attr("dir")||"").toLowerCase()==="rtl";return Boolean(i)},_calculatePosition:function(e,n,r){var i,s,o;var u=e.width();var a=n.height();var f=r.isOverflown||r.relative;if(f){i=s=0;o=-a}else{var l=e.offset();i=l.top;s=l.left;o=0}var c=e.data("promptPosition")||r.promptPosition;var h="";var p="";var d=0;var v=0;if(typeof c=="string"){if(c.indexOf(":")!=-1){h=c.substring(c.indexOf(":")+1);c=c.substring(0,c.indexOf(":"));if(h.indexOf(",")!=-1){p=h.substring(h.indexOf(",")+1);h=h.substring(0,h.indexOf(","));v=parseInt(p);if(isNaN(v)){v=0}}d=parseInt(h);if(isNaN(h)){h=0}}}if(!t.isRTL(e)){switch(c){default:case"topRight":if(f)s+=u-30;else{s+=u-130;i+=-a-2}break;case"topLeft":i+=-a-10;break;case"centerRight":if(f){i=e.outerHeight();s=e.outerWidth(1)+5}else{s+=e.outerWidth()+5}break;case"centerLeft":s-=n.width()+2;break;case"bottomLeft":i=i+e.height()+15;break;case"bottomRight":s+=u-30;i+=e.height()+5}}else{switch(c){default:case"topLeft":if(f)s-=n.width()-30;else{s-=n.width()-30;i+=-a-2}break;case"topRight":if(f)s+=u-n.width();else{s+=u-n.width();i+=-a-2}break;case"centerRight":if(f){i=e.outerHeight();s=e.outerWidth(1)+5}else{s+=e.outerWidth()+5}break;case"centerLeft":s-=n.width()+2;break;case"bottomLeft":s+=-n.width()+30;i=i+e.height()+15;break;case"bottomRight":s+=u-n.width();i+=e.height()+15}}s+=d;i+=v;return{callerTopPosition:i+"px",callerleftPosition:s+"px",marginTopSize:o+"px"}},_saveOptions:function(t,n){if(e.validationEngineLanguage)var r=e.validationEngineLanguage.allRules;else e.error("jQuery.validationEngine rules are not loaded, plz add localization files to the page");e.validationEngine.defaults.allrules=r;var i=e.extend(true,{},e.validationEngine.defaults,n);jim=i;if(i.isOverflown)i.relative=true;if(i.relative)i.isOverflown=true;t.data("jqv",i);return i},_getClassName:function(e){if(e){return e.replace(/:/g,"_").replace(/\./g,"_")}}};e.fn.validationEngine=function(n){var r=e(this);if(!r[0])return false;if(typeof n=="string"&&n.charAt(0)!="_"&&t[n]){if(n!="showPrompt"&&n!="hidePrompt"&&n!="hide"&&n!="hideAll")t.init.apply(r);return t[n].apply(r,Array.prototype.slice.call(arguments,1))}else if(typeof n=="object"||!n){t.init.apply(r,arguments);return t.attach.apply(r)}else{e.error("Method "+n+" does not exist in jQuery.validationEngine")}};e.validationEngine={defaults:{validationEventTrigger:"blur",scroll:true,focusFirstField:true,promptPosition:"topRight",bindMethod:"bind",inlineAjax:false,ajaxFormValidation:false,ajaxFormValidationURL:false,onAjaxFormComplete:e.noop,onBeforeAjaxFormValidation:e.noop,onValidationComplete:false,relative:false,isOverflown:false,overflownDIV:"",doNotShowAllErrosOnSubmit:false,binded:false,showArrow:true,isError:false,ajaxValidCache:{},autoPositionUpdate:false,InvalidFields:[],onSuccess:false,onFailure:false,autoHidePrompt:false,autoHideDelay:1e4}};e(function(){e.validationEngine.defaults.promptPosition=t.isRTL()?"topLeft":"topRight"})})(jQuery);

//////////////////////////////////////
// Tooltip tipsy
//////////////////////////////////////
(function(e){function t(e){if(e.attr("title")||typeof e.attr("original-title")!="string"){e.attr("original-title",e.attr("title")||"").removeAttr("title")}}function n(n,r){this.$element=e(n);this.options=r;this.enabled=true;t(this.$element)}n.prototype={show:function(){var t=this.getTitle();if(t&&this.enabled){var n=this.tip();n.find(".tipsy-inner")[this.options.html?"html":"text"](t);n[0].className="tipsy";n.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);var r=e.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});var i=n[0].offsetWidth,s=n[0].offsetHeight;var o=typeof this.options.gravity=="function"?this.options.gravity.call(this.$element[0]):this.options.gravity;var u;switch(o.charAt(0)){case"n":u={top:r.top+r.height+this.options.offset,left:r.left+r.width/2-i/2};break;case"s":u={top:r.top-s-this.options.offset,left:r.left+r.width/2-i/2};break;case"e":u={top:r.top+r.height/2-s/2,left:r.left-i-this.options.offset};break;case"w":u={top:r.top+r.height/2-s/2,left:r.left+r.width+this.options.offset};break}if(o.length==2){if(o.charAt(1)=="w"){u.left=r.left+r.width/2-15}else{u.left=r.left+r.width/2-i+15}}n.css(u).addClass("tipsy-"+o);if(this.options.fade){n.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity})}else{n.css({visibility:"visible",opacity:this.options.opacity})}}},hide:function(){if(this.options.fade){this.tip().stop().fadeOut(function(){e(this).remove()})}else{this.tip().remove()}},getTitle:function(){var e,n=this.$element,r=this.options;t(n);var e,r=this.options;if(typeof r.title=="string"){e=n.attr(r.title=="title"?"original-title":r.title)}else if(typeof r.title=="function"){e=r.title.call(n[0])}e=(""+e).replace(/(^\s*|\s*$)/,"");return e||r.fallback},tip:function(){if(!this.$tip){this.$tip=e('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"/></div>')}return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled}};e.fn.tipsy=function(t){function r(r){var i=e.data(r,"tipsy");if(!i){i=new n(r,e.fn.tipsy.elementOptions(r,t));e.data(r,"tipsy",i)}return i}function i(){var e=r(this);e.hoverState="in";if(t.delayIn==0){e.show()}else{setTimeout(function(){if(e.hoverState=="in")e.show()},t.delayIn)}}function s(){var e=r(this);e.hoverState="out";if(t.delayOut==0){e.hide()}else{setTimeout(function(){if(e.hoverState=="out")e.hide()},t.delayOut)}}if(t===true){return this.data("tipsy")}else if(typeof t=="string"){return this.data("tipsy")[t]()}t=e.extend({},e.fn.tipsy.defaults,t);if(!t.live)this.each(function(){r(this)});if(t.trigger!="manual"){var o=t.live?"live":"bind",u=t.trigger=="hover"?"mouseenter":"focus",a=t.trigger=="hover"?"mouseleave":"blur";this[o](u,i)[o](a,s)}return this};e.fn.tipsy.defaults={delayIn:0,delayOut:0,fade:false,fallback:"",gravity:"n",html:false,live:false,offset:0,opacity:.8,title:"title",trigger:"hover"};e.fn.tipsy.elementOptions=function(t,n){return e.metadata?e.extend({},n,e(t).metadata()):n};e.fn.tipsy.autoNS=function(){return e(this).offset().top>e(document).scrollTop()+e(window).height()/2?"s":"n"};e.fn.tipsy.autoWE=function(){return e(this).offset().left>e(document).scrollLeft()+e(window).width()/2?"e":"w"}})(jQuery);

//////////////////////////////////////
// Choosen plugin
//////////////////////////////////////
((function(){var a;a=function(){function a(){this.options_index=0,this.parsed=[]}return a.prototype.add_node=function(a){return a.nodeName==="OPTGROUP"?this.add_group(a):this.add_option(a)},a.prototype.add_group=function(a){var b,c,d,e,f,g;b=this.parsed.length,this.parsed.push({array_index:b,group:!0,label:a.label,children:0,disabled:a.disabled}),f=a.childNodes,g=[];for(d=0,e=f.length;d<e;d++)c=f[d],g.push(this.add_option(c,b,a.disabled));return g},a.prototype.add_option=function(a,b,c){if(a.nodeName==="OPTION")return a.text!==""?(b!=null&&(this.parsed[b].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:a.value,text:a.text,html:a.innerHTML,selected:a.selected,disabled:c===!0?c:a.disabled,group_array_index:b,classes:a.className,style:a.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1},a}(),a.select_to_array=function(b){var c,d,e,f,g;d=new a,g=b.childNodes;for(e=0,f=g.length;e<f;e++)c=g[e],d.add_node(c);return d.parsed},this.SelectParser=a})).call(this),function(){var a,b;b=this,a=function(){function a(a,b){this.form_field=a,this.options=b!=null?b:{},this.set_default_values(),this.is_multiple=this.form_field.multiple,this.default_text_default=this.is_multiple?"Select Some Options":"Select an Option",this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup()}return a.prototype.set_default_values=function(){var a=this;return this.click_test_action=function(b){return a.test_active_click(b)},this.activate_action=function(b){return a.activate_field(b)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=this.options.allow_single_deselect!=null&&this.form_field.options[0]!=null&&this.form_field.options[0].text===""?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.choices=0,this.results_none_found=this.options.no_results_text||"No results match"},a.prototype.mouse_enter=function(){return this.mouse_on_container=!0},a.prototype.mouse_leave=function(){return this.mouse_on_container=!1},a.prototype.input_focus=function(a){var b=this;if(!this.active_field)return setTimeout(function(){return b.container_mousedown()},50)},a.prototype.input_blur=function(a){var b=this;if(!this.mouse_on_container)return this.active_field=!1,setTimeout(function(){return b.blur_test()},100)},a.prototype.result_add_option=function(a){var b,c;return a.disabled?"":(a.dom_id=this.container_id+"_o_"+a.array_index,b=a.selected&&this.is_multiple?[]:["active-result"],a.selected&&b.push("result-selected"),a.group_array_index!=null&&b.push("group-option"),a.classes!==""&&b.push(a.classes),c=a.style.cssText!==""?' style="'+a.style+'"':"",'<li id="'+a.dom_id+'" class="'+b.join(" ")+'"'+c+">"+a.html+"</li>")},a.prototype.results_update_field=function(){return this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},a.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},a.prototype.results_search=function(a){return this.results_showing?this.winnow_results():this.results_show()},a.prototype.keyup_checker=function(a){var b,c;b=(c=a.which)!=null?c:a.keyCode,this.search_field_scale();switch(b){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:a.preventDefault();if(this.results_showing)return this.result_select(a);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},a.prototype.generate_field_id=function(){var a;return a=this.generate_random_id(),this.form_field.id=a,a},a.prototype.generate_random_char=function(){var a,b,c;return a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ",c=Math.floor(Math.random()*a.length),b=a.substring(c,c+1)},a}(),b.AbstractChosen=a}.call(this),function(){var a,b,c,d,e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};d=this,a=jQuery,a.fn.extend({chosen:function(c){return!a.browser.msie||a.browser.version!=="6.0"&&a.browser.version!=="7.0"?a(this).each(function(d){if(!a(this).hasClass("chzn-done"))return new b(this,c)}):this}}),b=function(b){function e(){e.__super__.constructor.apply(this,arguments)}return f(e,b),e.prototype.setup=function(){return this.form_field_jq=a(this.form_field),this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},e.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")},e.prototype.set_up_html=function(){var b,d,e,f;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/(:|\.)/g,"_"):this.generate_field_id(),this.container_id+="_chzn",this.f_width=this.form_field_jq.outerWidth(),this.default_text=this.form_field_jq.data("placeholder")?this.form_field_jq.data("placeholder"):this.default_text_default,b=a("<div />",{id:this.container_id,"class":"chzn-container"+(this.is_rtl?" chzn-rtl":""),style:"width: "+this.f_width+"px;"}),this.is_multiple?b.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>'):b.html('<a href="javascript:void(0)" class="chzn-single"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(b),this.container=a("#"+this.container_id),this.container.addClass("chzn-container-"+(this.is_multiple?"multi":"single")),this.dropdown=this.container.find("div.chzn-drop").first(),d=this.container.height(),e=this.f_width-c(this.dropdown),this.dropdown.css({width:e+"px",top:d+"px"}),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first(),f=e-c(this.search_container)-c(this.search_field),this.search_field.css({width:f+"px"})),this.results_build(),this.set_tab_index(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},e.prototype.register_observers=function(){var a=this;return this.container.mousedown(function(b){return a.container_mousedown(b)}),this.container.mouseup(function(b){return a.container_mouseup(b)}),this.container.mouseenter(function(b){return a.mouse_enter(b)}),this.container.mouseleave(function(b){return a.mouse_leave(b)}),this.search_results.mouseup(function(b){return a.search_results_mouseup(b)}),this.search_results.mouseover(function(b){return a.search_results_mouseover(b)}),this.search_results.mouseout(function(b){return a.search_results_mouseout(b)}),this.form_field_jq.bind("liszt:updated",function(b){return a.results_update_field(b)}),this.search_field.blur(function(b){return a.input_blur(b)}),this.search_field.keyup(function(b){return a.keyup_checker(b)}),this.search_field.keydown(function(b){return a.keydown_checker(b)}),this.is_multiple?(this.search_choices.click(function(b){return a.choices_click(b)}),this.search_field.focus(function(b){return a.input_focus(b)})):this.container.click(function(a){return a.preventDefault()})},e.prototype.search_field_disabled=function(){this.is_disabled=this.form_field_jq[0].disabled;if(this.is_disabled)return this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field();this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1;if(!this.is_multiple)return this.selected_item.bind("focus",this.activate_action)},e.prototype.container_mousedown=function(b){var c;if(!this.is_disabled)return c=b!=null?a(b.target).hasClass("search-choice-close"):!1,b&&b.type==="mousedown"&&b.stopPropagation(),!this.pending_destroy_click&&!c?(this.active_field?!this.is_multiple&&b&&(a(b.target)[0]===this.selected_item[0]||a(b.target).parents("a.chzn-single").length)&&(b.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),a(document).click(this.click_test_action),this.results_show()),this.activate_field()):this.pending_destroy_click=!1},e.prototype.container_mouseup=function(a){if(a.target.nodeName==="ABBR")return this.results_reset(a)},e.prototype.blur_test=function(a){if(!this.active_field&&this.container.hasClass("chzn-container-active"))return this.close_field()},e.prototype.close_field=function(){return a(document).unbind("click",this.click_test_action),this.is_multiple||(this.selected_item.attr("tabindex",this.search_field.attr("tabindex")),this.search_field.attr("tabindex",-1)),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},e.prototype.activate_field=function(){return!this.is_multiple&&!this.active_field&&(this.search_field.attr("tabindex",this.selected_item.attr("tabindex")),this.selected_item.attr("tabindex",-1)),this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},e.prototype.test_active_click=function(b){return a(b.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},e.prototype.results_build=function(){var a,b,c,e,f;this.parsing=!0,this.results_data=d.SelectParser.select_to_array(this.form_field),this.is_multiple&&this.choices>0?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||(this.selected_item.find("span").text(this.default_text),this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):this.container.removeClass("chzn-container-single-nosearch")),a="",f=this.results_data;for(c=0,e=f.length;c<e;c++)b=f[c],b.group?a+=this.result_add_group(b):b.empty||(a+=this.result_add_option(b),b.selected&&this.is_multiple?this.choice_build(b):b.selected&&!this.is_multiple&&(this.selected_item.find("span").text(b.text),this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(a),this.parsing=!1},e.prototype.result_add_group=function(b){return b.disabled?"":(b.dom_id=this.container_id+"_g_"+b.array_index,'<li id="'+b.dom_id+'" class="group-result">'+a("<div />").text(b.label).html()+"</li>")},e.prototype.result_do_highlight=function(a){var b,c,d,e,f;if(a.length){this.result_clear_highlight(),this.result_highlight=a,this.result_highlight.addClass("highlighted"),d=parseInt(this.search_results.css("maxHeight"),10),f=this.search_results.scrollTop(),e=d+f,c=this.result_highlight.position().top+this.search_results.scrollTop(),b=c+this.result_highlight.outerHeight();if(b>=e)return this.search_results.scrollTop(b-d>0?b-d:0);if(c<f)return this.search_results.scrollTop(c)}},e.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},e.prototype.results_show=function(){var a;return this.is_multiple||(this.selected_item.addClass("chzn-single-with-drop"),this.result_single_selected&&this.result_do_highlight(this.result_single_selected)),a=this.is_multiple?this.container.height():this.container.height()-1,this.dropdown.css({top:a+"px",left:0}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results()},e.prototype.results_hide=function(){return this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop"),this.result_clear_highlight(),this.dropdown.css({left:"-9000px"}),this.results_showing=!1},e.prototype.set_tab_index=function(a){var b;if(this.form_field_jq.attr("tabindex"))return b=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.is_multiple?this.search_field.attr("tabindex",b):(this.selected_item.attr("tabindex",b),this.search_field.attr("tabindex",-1))},e.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},e.prototype.search_results_mouseup=function(b){var c;c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first();if(c.length)return this.result_highlight=c,this.result_select(b)},e.prototype.search_results_mouseover=function(b){var c;c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first();if(c)return this.result_do_highlight(c)},e.prototype.search_results_mouseout=function(b){if(a(b.target).hasClass("active-result"))return this.result_clear_highlight()},e.prototype.choices_click=function(b){b.preventDefault();if(this.active_field&&!a(b.target).hasClass("search-choice")&&!this.results_showing)return this.results_show()},e.prototype.choice_build=function(b){var c,d,e=this;return c=this.container_id+"_c_"+b.array_index,this.choices+=1,this.search_container.before('<li class="search-choice" id="'+c+'"><span>'+b.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+b.array_index+'"></a></li>'),d=a("#"+c).find("a").first(),d.click(function(a){return e.choice_destroy_link_click(a)})},e.prototype.choice_destroy_link_click=function(b){return b.preventDefault(),this.is_disabled?b.stopPropagation:(this.pending_destroy_click=!0,this.choice_destroy(a(b.target)))},e.prototype.choice_destroy=function(a){return this.choices-=1,this.show_search_field_default(),this.is_multiple&&this.choices>0&&this.search_field.val().length<1&&this.results_hide(),this.result_deselect(a.attr("rel")),a.parents("li").first().remove()},e.prototype.results_reset=function(b){this.form_field.options[0].selected=!0,this.selected_item.find("span").text(this.default_text),this.show_search_field_default(),a(b.target).remove(),this.form_field_jq.trigger("change");if(this.active_field)return this.results_hide()},e.prototype.result_select=function(a){var b,c,d,e;if(this.result_highlight)return b=this.result_highlight,c=b.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(b):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=b),b.addClass("result-selected"),e=c.substr(c.lastIndexOf("_")+1),d=this.results_data[e],d.selected=!0,this.form_field.options[d.options_index].selected=!0,this.is_multiple?this.choice_build(d):(this.selected_item.find("span").first().text(d.text),this.allow_single_deselect&&this.single_deselect_control_build()),(!a.metaKey||!this.is_multiple)&&this.results_hide(),this.search_field.val(""),this.form_field_jq.trigger("change"),this.search_field_scale()},e.prototype.result_activate=function(a){return a.addClass("active-result")},e.prototype.result_deactivate=function(a){return a.removeClass("active-result")},e.prototype.result_deselect=function(b){var c,d;return d=this.results_data[b],d.selected=!1,this.form_field.options[d.options_index].selected=!1,c=a("#"+this.container_id+"_o_"+b),c.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change"),this.search_field_scale()},e.prototype.single_deselect_control_build=function(){if(this.allow_single_deselect&&this.selected_item.find("abbr").length<1)return this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')},e.prototype.winnow_results=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;this.no_results_clear(),i=0,j=this.search_field.val()===this.default_text?"":a("<div/>").text(a.trim(this.search_field.val())).html(),f=new RegExp("^"+j.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),m=new RegExp(j.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),r=this.results_data;for(n=0,p=r.length;n<p;n++){c=r[n];if(!c.disabled&&!c.empty)if(c.group)a("#"+c.dom_id).css("display","none");else if(!this.is_multiple||!c.selected){b=!1,h=c.dom_id,g=a("#"+h);if(f.test(c.html))b=!0,i+=1;else if(c.html.indexOf(" ")>=0||c.html.indexOf("[")===0){e=c.html.replace(/\[|\]/g,"").split(" ");if(e.length)for(o=0,q=e.length;o<q;o++)d=e[o],f.test(d)&&(b=!0,i+=1)}b?(j.length?(k=c.html.search(m),l=c.html.substr(0,k+j.length)+"</em>"+c.html.substr(k+j.length),l=l.substr(0,k)+"<em>"+l.substr(k)):l=c.html,g.html(l),this.result_activate(g),c.group_array_index!=null&&a("#"+this.results_data[c.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&h===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(g))}}return i<1&&j.length?this.no_results(j):this.winnow_results_set_highlight()},e.prototype.winnow_results_clear=function(){var b,c,d,e,f;this.search_field.val(""),c=this.search_results.find("li"),f=[];for(d=0,e=c.length;d<e;d++)b=c[d],b=a(b),b.hasClass("group-result")?f.push(b.css("display","auto")):!this.is_multiple||!b.hasClass("result-selected")?f.push(this.result_activate(b)):f.push(void 0);return f},e.prototype.winnow_results_set_highlight=function(){var a,b;if(!this.result_highlight){b=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),a=b.length?b.first():this.search_results.find(".active-result").first();if(a!=null)return this.result_do_highlight(a)}},e.prototype.no_results=function(b){var c;return c=a('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),c.find("span").first().html(b),this.search_results.append(c)},e.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},e.prototype.keydown_arrow=function(){var b,c;this.result_highlight?this.results_showing&&(c=this.result_highlight.nextAll("li.active-result").first(),c&&this.result_do_highlight(c)):(b=this.search_results.find("li.active-result").first(),b&&this.result_do_highlight(a(b)));if(!this.results_showing)return this.results_show()},e.prototype.keyup_arrow=function(){var a;if(!this.results_showing&&!this.is_multiple)return this.results_show();if(this.result_highlight)return a=this.result_highlight.prevAll("li.active-result"),a.length?this.result_do_highlight(a.first()):(this.choices>0&&this.results_hide(),this.result_clear_highlight())},e.prototype.keydown_backstroke=function(){return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(this.pending_backstroke=this.search_container.siblings("li.search-choice").last(),this.pending_backstroke.addClass("search-choice-focus"))},e.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},e.prototype.keydown_checker=function(a){var b,c;b=(c=a.which)!=null?c:a.keyCode,this.search_field_scale(),b!==8&&this.pending_backstroke&&this.clear_backstroke();switch(b){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(a),this.mouse_on_container=!1;break;case 13:a.preventDefault();break;case 38:a.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},e.prototype.search_field_scale=function(){var b,c,d,e,f,g,h,i,j;if(this.is_multiple){d=0,h=0,f="position:absolute; left: -1000px; top: -1000px; display:none;",g=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"];for(i=0,j=g.length;i<j;i++)e=g[i],f+=e+":"+this.search_field.css(e)+";";return c=a("<div />",{style:f}),c.text(this.search_field.val()),a("body").append(c),h=c.width()+25,c.remove(),h>this.f_width-10&&(h=this.f_width-10),this.search_field.css({width:h+"px"}),b=this.container.height(),this.dropdown.css({top:b+"px"})}},e.prototype.generate_random_id=function(){var b;b="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();while(a("#"+b).length>0)b+=this.generate_random_char();return b},e}(AbstractChosen),c=function(a){var b;return b=a.outerWidth()-a.width()},d.get_side_border_padding=c}.call(this);

//////////////////////////////////////
// Collapsible plugin
//////////////////////////////////////
(function($){$.fn.collapsible=function(cmd,arg){if(typeof cmd=='string'){return $.fn.collapsible.dispatcher[cmd](this,arg);}return $.fn.collapsible.dispatcher['_create'](this,cmd);};$.fn.collapsible.dispatcher={_create:function(obj,arg){createCollapsible(obj,arg);},toggle:function(obj){toggle(obj,loadOpts(obj));return obj;},open:function(obj){open(obj,loadOpts(obj));return obj;},close:function(obj){close(obj,loadOpts(obj));return obj;},collapsed:function(obj){return collapsed(obj,loadOpts(obj));}};function createCollapsible(obj,options){var opts=$.extend({},$.fn.collapsible.defaults,options);var opened=new Array();obj.each(function(){var $this=$(this);saveOpts($this,opts);if(opts.bind=='mouseenter'){$this.bind('mouseenter',function(e){e.preventDefault();toggle($this,opts);});}if(opts.bind=='mouseover'){$this.bind('mouseover',function(e){e.preventDefault();toggle($this,opts);});}if(opts.bind=='click'){$this.bind('click',function(e){e.preventDefault();toggle($this,opts);});}if(opts.bind=='dblclick'){$this.bind('dblclick',function(e){e.preventDefault();toggle($this,opts);});}id=$this.attr('id');if(!useCookies(opts)){dOpenIndex=inDefaultOpen(id,opts);if(dOpenIndex===false){$this.addClass(opts.cssClose);$this.next().hide();}else{$this.addClass(opts.cssOpen);$this.next().show();opened.push(id);}}else{if(issetCookie(opts)){cookieIndex=inCookie(id,opts);if(cookieIndex===false){$this.addClass(opts.cssClose);$this.next().hide();}else{$this.addClass(opts.cssOpen);$this.next().show();opened.push(id);}}else{dOpenIndex=inDefaultOpen(id,opts);if(dOpenIndex===false){$this.addClass(opts.cssClose);$this.next().hide();}else{$this.addClass(opts.cssOpen);$this.next().show();opened.push(id);}}}});if(opened.length>0&&useCookies(opts)){setCookie(opened.toString(),opts);}else{setCookie('',opts);}return obj;};function loadOpts($this){return $this.data('collapsible-opts');}function saveOpts($this,opts){return $this.data('collapsible-opts',opts);}function collapsed($this,opts){return $this.hasClass(opts.cssClose);}function close($this,opts){$this.addClass(opts.cssClose).removeClass(opts.cssOpen);opts.animateOpen($this,opts);if(useCookies(opts)){id=$this.attr('id');unsetCookieId(id,opts);}}function open($this,opts){$this.removeClass(opts.cssClose).addClass(opts.cssOpen);opts.animateClose($this,opts);if(useCookies(opts)){id=$this.attr('id');appendCookie(id,opts);}}function toggle($this,opts){if(collapsed($this,opts)){open($this,opts);}else{close($this,opts);}return false;}function useCookies(opts){if(!$.cookie||opts.cookieName==''){return false;}return true;}function appendCookie(value,opts){if(!useCookies(opts)){return false;}if(!issetCookie(opts)){setCookie(value,opts);return true;}if(inCookie(value,opts)){return true;}cookie=$.cookie(opts.cookieName);cookie=unescape(cookie);cookieArray=cookie.split(',');cookieArray.push(value);setCookie(cookieArray.toString(),opts);return true;}function unsetCookieId(value,opts){if(!useCookies(opts)){return false;}if(!issetCookie(opts)){return true;}cookieIndex=inCookie(value,opts);if(cookieIndex===false){return true;}cookie=$.cookie(opts.cookieName);cookie=unescape(cookie);cookieArray=cookie.split(',');cookieArray.splice(cookieIndex,1);setCookie(cookieArray.toString(),opts);}function setCookie(value,opts){if(!useCookies(opts)){return false;}$.cookie(opts.cookieName,value,opts.cookieOptions);}function inCookie(value,opts){if(!useCookies(opts)){return false;}if(!issetCookie(opts)){return false;}cookie=unescape($.cookie(opts.cookieName));cookieArray=cookie.split(',');cookieIndex=$.inArray(value,cookieArray);if(cookieIndex==-1){return false;}return cookieIndex;}function issetCookie(opts){if(!useCookies(opts)){return false;}if($.cookie(opts.cookieName)==null){return false;}return true;}function inDefaultOpen(id,opts){defaultOpen=getDefaultOpen(opts);index=$.inArray(id,defaultOpen);if(index==-1){return false;}return index;}function getDefaultOpen(opts){defaultOpen=new Array();if(opts.defaultOpen!=''){defaultOpen=opts.defaultOpen.split(',');}return defaultOpen;}$.fn.collapsible.defaults={cssClose:'collapse-close',cssOpen:'collapse-open',cookieName:'collapsible',cookieOptions:{path:'/',expires:7,domain:'',secure:''},defaultOpen:'',speed:'slow',bind:'click',animateOpen:function(elem,opts){elem.next().slideUp(opts.speed);},animateClose:function(elem,opts){elem.next().slideDown(opts.speed);}};})(jQuery);

//////////////////////////////////////
// BreadCrumbs plugin
//////////////////////////////////////
(function(e){e.fn.xBreadcrumbs=function(t){function r(){if(t.collapsible){var r=n.children("LI").length;n.children("LI").children("A").css("white-space","nowrap").css("float","left");n.children("LI").children("A").each(function(n,i){if(n!=r-1){e(this).css("overflow","hidden");e(this).attr("init-width",e(this).width());e(this).width(t.collapsedWidth)}})}n.children("LI").mouseenter(function(){if(e(this).hasClass("hover")){return}i();if(!o(e(this))){return}var n=e(this).children("UL");s(n,true);if(t.collapsible&&!e(this).hasClass("current")){var r=e(this).children("A").attr("init-width");e(this).children("A").animate({width:r},"normal")}});n.children("LI").mouseleave(function(){var n=e(this).children("UL");s(n,false);if(t.collapsible&&!e(this).hasClass("current")){e(this).children("A").animate({width:t.collapsedWidth},"fast")}})}function i(){n.children("LI").children("UL").each(function(){e(this).hide();e(this).parent().removeClass("hover")})}function s(n,r){if(r){n.parent().addClass("hover");if(e.browser.msie){var i=n.parent().position();n.css("left",parseInt(i["left"]))}if(t.showSpeed!=""){n.fadeIn(t.showSpeed)}else{n.show()}}else{n.parent().removeClass("hover");if(t.hideSpeed!=""){n.fadeOut(t.hideSpeed)}else{n.hide()}}}function o(e){return e.children("UL").length>0}var n=e(this);var t=e.extend({},e.fn.xBreadcrumbs.defaults,t);r()};e.fn.xBreadcrumbs.defaults={showSpeed:"fast",hideSpeed:"",collapsible:false,collapsedWidth:10}})(jQuery);
